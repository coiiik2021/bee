<!DOCTYPE html>
<html lang="en" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{/admin/template}" >
<head>
  <meta charset="UTF-8">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <title>Quản lí khách hàng</title>
  <script>
    function search() {
      var formContainer = document.getElementById('searchForm');
      if(formContainer.style.display === 'none'){
        formContainer.style.display = 'block';
      } else{
        formContainer.style.display = 'none';
      }
    }
    document.addEventListener('DOMContentLoaded', function() {
      const fileInput = document.getElementById('fileInput');
      if (fileInput) {
        fileInput.addEventListener('change', function() {
          if (this.files.length > 0) {
            document.getElementById('importForm').submit();
          }
        });
      }
    });
  </script>
</head>
<body>
<main class="content px-3 py-4" layout:fragment="main">
  <h1>Quản lí khách hàng</h1>
  <div class="d-flex justify-content-end mt-3">
    <button class="btn btn-outline-success" type="button" onclick="search()">Tìm kiếm</button>
    <button class="btn btn-outline-success ml-5" type="button"
            onclick="window.location.href='/admin/customer/export'">Xuất file</button>
    <form id="importForm" action="/admin/customer/import" method="POST" enctype="multipart/form-data">
      <input type="file" name="file" id="fileInput" required style="display: none;">
      <button class="btn btn-outline-success" type="button" onclick="document.getElementById('fileInput').click();">Nhập file</button>
    </form>
  </div>
  <div id="searchForm" style="display: none" class="mt-3">
    <form  class="form-inline" th:action="@{/admin/customer/search}" method="get" >
      <input type="text" class="form-control mr-2" placeholder="Nhập tên hoặc username" name="searchValue">
      <button class="btn btn-outline-success" type="submit">Tìm kiếm</button>
    </form>
  </div>
  <form id="dataTableForm" method="get" th:action="@{/admin/customer}">
    <div class="dataTables_length" id="DataTables_Table_0_length">
      <label>Show
        <select name="size" onchange="this.form.submit()" class="custom-select custom-select-sm ">
          <option value="10" th:selected="${size == 10}">10</option>
          <option value="25" th:selected="${size == 25}">25</option>
          <option value="50" th:selected="${size == 50}">50</option>
          <option value="100" th:selected="${size == 100}">100</option>
        </select> entries
      </label>
    </div>
  </form>
  <table class="table table-success table-striped mt-3">
    <thead>
    <tr>
      <th scope="col">STT</th>
      <th scope="col">Username</th>
      <th scope="col">Fullname</th>
      <th scope="col">Email</th>
      <th scope="col">Address</th>
      <th scope="col">City</th>
      <th scope="col">District</th>
      <th scope="col">Ward</th>
      <th scope="col">Country</th>
      <th scope="col">Photo</th>
      <th scope="col">Phone</th>
      <th scope="col">Created Date</th>
      <th scope="col">Status</th>
      <th scope="col">Action</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="customer,stat : ${customers}" >
      <td th:text="${stat.index+1}"></td>
      <td th:text="${customer.username}"></td>
      <td th:text="${customer.fullname}"></td>
      <td th:text="${customer.email}"></td>
      <td th:text="${customer.address}"></td>
      <td th:text="${customer.city}"></td>
      <td th:text="${customer.district}"></td>
      <td th:text="${customer.ward}"></td>
      <td th:text="${customer.country}"></td>
      <td th:text="${customer.photo}"></td>
      <td th:text="${customer.phone}"></td>
      <td th:text="${#temporals.format(customer.createdDate, 'dd-MM-yyyy')}"></td>
      <td th:text="${customer.status==1?'Active':'Inactive'}"></td>

      <td>
        <a th:href="@{/admin/customer/detail/{id}(id=${customer.id})}" class="btn btn-outline-primary" >Detail</a>
        <a th:href="@{/admin/customer/delete/{id}(id=${customer.id})}" class="btn btn-outline-danger" onclick="return confirm('Bạn có chắc muốn xóa')">Delete</a>
      </td>
    </tr>
    </tbody>
  </table>
      <div class="pagination d-flex justify-content-center">
          <li class="paginate_button page-item previous" th:class="${currentPage == 0} ? 'disabled'">
              <a th:href="@{/admin/customer(page=${currentPage - 1}, size=${size})}" class="page-link">Previous</a>
          </li>
          <li class="paginate_button page-item next" th:class="${currentPage + 1 >= totalPages} ? 'disabled'">
              <a th:href="@{/admin/customer(page=${currentPage + 1}, size=${size})}" class="btn btn-primary">Next</a>
          </li>
      </div>
  <h2 style="text-decoration-color: aqua; font-weight: bold">Thêm Khách Hàng</h2>
  <div class="container mt-2 " style="display: block">
    <form th:action="@{/admin/customer/add}" th:object="${customer}" method="post" >

      <div class="form-group">
        <label>Username</label>
        <input type="text" name="username" class="form-control" required/>
      </div>

      <div class="form-group">
        <label>Password</label>
        <input type="password" name="password" class="form-control" required/>
      </div>

      <div class="form-group">
        <label>Fullname</label>
        <input type="text" name="fullname" class="form-control" required/>
      </div>

      <div class="form-group">
        <label>Email</label>
        <input type="email" name="email" class="form-control" required/>
      </div>

      <div class="form-group">
        <label>Address</label>
        <input type="address" name="address" class="form-control" required/>
      </div>

      <div class="form-group">
        <label>City</label>
        <input type="city" name="city" class="form-control" required/>
      </div>

      <div class="form-group">
        <label>District</label>
        <input type="district" name="district" class="form-control" required/>
      </div>

      <div class="form-group">
        <label>Ward</label>
        <input type="ward" name="ward" class="form-control" required/>
      </div>

      <div class="form-group">
        <label>Country</label>
        <input type="country" name="country" class="form-control" required/>
      </div>

      <div class="form-group">
        <label>Phone</label>
        <input type="text" name="phone" class="form-control" required/>
      </div>

      <div class="form-group">
        <label>Status</label><br>
        <input type="radio"  name="status" value="1"}>
        <label>Active</label>
        <input class="ml-5" type="radio"  name="status" value="0" }>
        <label>Inactive</label>
      </div>

      <div class="form-group">
        <label for="photo">Photo</label>
        <input type="file" name="photo" id="photo" class="form-control" accept="image/*">
      </div>

      <div class="d-flex justify-content-center">
        <button type="submit" class="btn btn-primary me-2">Save</button>
      </div>

    </form>
  </div>
</main>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>